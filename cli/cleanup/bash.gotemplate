#!/bin/bash

set -eu

input_paths=()
{{range . -}}
input_paths+=("{{.Path}}")
{{end}}

target_paths=()
{{range . -}}
target_paths+=("{{.TargetPath}}")
{{end}}

echo "Check preconditions, if all the input files exist"

for path in ${input_paths[@]}; do
    if [[ ! -d "${path}"]]; then
        echo "Missing dir {$path}. Aborting."
        exit 1
    fi
done

echo "Prepare target directory tree"

for path in ${target_path[@]}; do
    mkdir -p "${path}"
done
